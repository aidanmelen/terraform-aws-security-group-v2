=== RUN   TestTerraformCustomRulesExample
TestTerraformCustomRulesExample 2022-08-24T14:34:46Z retry.go:91: terraform [init -upgrade=false]
TestTerraformCustomRulesExample 2022-08-24T14:34:46Z logger.go:66: Running command terraform with args [init -upgrade=false]
TestTerraformCustomRulesExample 2022-08-24T14:34:46Z logger.go:66: [0m[1mInitializing modules...[0m
TestTerraformCustomRulesExample 2022-08-24T14:34:46Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:46Z logger.go:66: [0m[1mInitializing the backend...[0m
TestTerraformCustomRulesExample 2022-08-24T14:34:47Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:47Z logger.go:66: [0m[1mInitializing provider plugins...[0m
TestTerraformCustomRulesExample 2022-08-24T14:34:47Z logger.go:66: - Reusing previous version of hashicorp/aws from the dependency lock file
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: - Using previously-installed hashicorp/aws v4.27.0
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: [0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: [0m[32m
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: You may now begin working with Terraform. Try running "terraform plan" to see
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: any changes that are required for your infrastructure. All Terraform commands
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: should now work.
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: If you ever set or change modules or backend configuration for Terraform,
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: rerun this command to reinitialize your working directory. If you forget, other
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: commands will detect it and remind you to do so if necessary.[0m
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z retry.go:91: terraform [apply -input=false -auto-approve -no-color -lock=false]
TestTerraformCustomRulesExample 2022-08-24T14:34:48Z logger.go:66: Running command terraform with args [apply -input=false -auto-approve -no-color -lock=false]
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: Error: Reference to undeclared input variable
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:   on ../../auto_group_rules.tf line 26, in resource "aws_security_group_rule" "auto_group_ingress_https_from_public_internet_rules":
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:   26:   for_each = var.create && var.create_auto_group_ingress_https_from_public_internet_rules ? { "ingress-https-443-tcp-from-public-internet" = null } : {}
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: An input variable with the name
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: "create_auto_group_ingress_https_from_public_internet_rules" has not been
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: declared. This variable can be declared with a variable
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: "create_auto_group_ingress_https_from_public_internet_rules" {} block.
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: Error: Reference to undeclared input variable
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:   on ../../auto_group_rules.tf line 44, in resource "aws_security_group_rule" "auto_group_ingress_http_from_public_internet_rules":
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:   44:   for_each = var.create && var.create_auto_group_ingress_http_from_public_internet_rules ? { "ingress-http-80-tcp-from-public-internet" = null } : {}
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: An input variable with the name
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: "create_auto_group_ingress_http_from_public_internet_rules" has not been
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: declared. This variable can be declared with a variable
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: "create_auto_group_ingress_http_from_public_internet_rules" {} block.
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z retry.go:99: Returning due to fatal error: FatalError{Underlying: error while running command: exit status 1;
Error: Reference to undeclared input variable

  on ../../auto_group_rules.tf line 26, in resource "aws_security_group_rule" "auto_group_ingress_https_from_public_internet_rules":
  26:   for_each = var.create && var.create_auto_group_ingress_https_from_public_internet_rules ? { "ingress-https-443-tcp-from-public-internet" = null } : {}

An input variable with the name
"create_auto_group_ingress_https_from_public_internet_rules" has not been
declared. This variable can be declared with a variable
"create_auto_group_ingress_https_from_public_internet_rules" {} block.

Error: Reference to undeclared input variable

  on ../../auto_group_rules.tf line 44, in resource "aws_security_group_rule" "auto_group_ingress_http_from_public_internet_rules":
  44:   for_each = var.create && var.create_auto_group_ingress_http_from_public_internet_rules ? { "ingress-http-80-tcp-from-public-internet" = null } : {}

An input variable with the name
"create_auto_group_ingress_http_from_public_internet_rules" has not been
declared. This variable can be declared with a variable
"create_auto_group_ingress_http_from_public_internet_rules" {} block.}
    apply.go:15:
        	Error Trace:	/workspaces/terraform-aws-security-group/test/apply.go:15
        	            				/workspaces/terraform-aws-security-group/test/terraform_custom_rules_test.go:23
        	Error:      	Received unexpected error:
        	            	FatalError{Underlying: error while running command: exit status 1;
        	            	Error: Reference to undeclared input variable

        	            	  on ../../auto_group_rules.tf line 26, in resource "aws_security_group_rule" "auto_group_ingress_https_from_public_internet_rules":
        	            	  26:   for_each = var.create && var.create_auto_group_ingress_https_from_public_internet_rules ? { "ingress-https-443-tcp-from-public-internet" = null } : {}

        	            	An input variable with the name
        	            	"create_auto_group_ingress_https_from_public_internet_rules" has not been
        	            	declared. This variable can be declared with a variable
        	            	"create_auto_group_ingress_https_from_public_internet_rules" {} block.

        	            	Error: Reference to undeclared input variable

        	            	  on ../../auto_group_rules.tf line 44, in resource "aws_security_group_rule" "auto_group_ingress_http_from_public_internet_rules":
        	            	  44:   for_each = var.create && var.create_auto_group_ingress_http_from_public_internet_rules ? { "ingress-http-80-tcp-from-public-internet" = null } : {}

        	            	An input variable with the name
        	            	"create_auto_group_ingress_http_from_public_internet_rules" has not been
        	            	declared. This variable can be declared with a variable
        	            	"create_auto_group_ingress_http_from_public_internet_rules" {} block.}
        	Test:       	TestTerraformCustomRulesExample
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z retry.go:91: terraform [destroy -auto-approve -input=false -no-color -lock=false]
TestTerraformCustomRulesExample 2022-08-24T14:34:50Z logger.go:66: Running command terraform with args [destroy -auto-approve -input=false -no-color -lock=false]
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: Error: Reference to undeclared input variable
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:   on ../../auto_group_rules.tf line 26, in resource "aws_security_group_rule" "auto_group_ingress_https_from_public_internet_rules":
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:   26:   for_each = var.create && var.create_auto_group_ingress_https_from_public_internet_rules ? { "ingress-https-443-tcp-from-public-internet" = null } : {}
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: An input variable with the name
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: "create_auto_group_ingress_https_from_public_internet_rules" has not been
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: declared. This variable can be declared with a variable
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: "create_auto_group_ingress_https_from_public_internet_rules" {} block.
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: Error: Reference to undeclared input variable
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:   on ../../auto_group_rules.tf line 44, in resource "aws_security_group_rule" "auto_group_ingress_http_from_public_internet_rules":
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:   44:   for_each = var.create && var.create_auto_group_ingress_http_from_public_internet_rules ? { "ingress-http-80-tcp-from-public-internet" = null } : {}
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66:
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: An input variable with the name
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: "create_auto_group_ingress_http_from_public_internet_rules" has not been
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: declared. This variable can be declared with a variable
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z logger.go:66: "create_auto_group_ingress_http_from_public_internet_rules" {} block.
TestTerraformCustomRulesExample 2022-08-24T14:34:52Z retry.go:99: Returning due to fatal error: FatalError{Underlying: error while running command: exit status 1;
Error: Reference to undeclared input variable

  on ../../auto_group_rules.tf line 26, in resource "aws_security_group_rule" "auto_group_ingress_https_from_public_internet_rules":
  26:   for_each = var.create && var.create_auto_group_ingress_https_from_public_internet_rules ? { "ingress-https-443-tcp-from-public-internet" = null } : {}

An input variable with the name
"create_auto_group_ingress_https_from_public_internet_rules" has not been
declared. This variable can be declared with a variable
"create_auto_group_ingress_https_from_public_internet_rules" {} block.

Error: Reference to undeclared input variable

  on ../../auto_group_rules.tf line 44, in resource "aws_security_group_rule" "auto_group_ingress_http_from_public_internet_rules":
  44:   for_each = var.create && var.create_auto_group_ingress_http_from_public_internet_rules ? { "ingress-http-80-tcp-from-public-internet" = null } : {}

An input variable with the name
"create_auto_group_ingress_http_from_public_internet_rules" has not been
declared. This variable can be declared with a variable
"create_auto_group_ingress_http_from_public_internet_rules" {} block.}
    destroy.go:11:
        	Error Trace:	/workspaces/terraform-aws-security-group/test/destroy.go:11
        	            				/workspaces/terraform-aws-security-group/test/panic.go:642
        	            				/workspaces/terraform-aws-security-group/test/testing.go:756
        	            				/workspaces/terraform-aws-security-group/test/apply.go:15
        	            				/workspaces/terraform-aws-security-group/test/terraform_custom_rules_test.go:23
        	Error:      	Received unexpected error:
        	            	FatalError{Underlying: error while running command: exit status 1;
        	            	Error: Reference to undeclared input variable

        	            	  on ../../auto_group_rules.tf line 26, in resource "aws_security_group_rule" "auto_group_ingress_https_from_public_internet_rules":
        	            	  26:   for_each = var.create && var.create_auto_group_ingress_https_from_public_internet_rules ? { "ingress-https-443-tcp-from-public-internet" = null } : {}

        	            	An input variable with the name
        	            	"create_auto_group_ingress_https_from_public_internet_rules" has not been
        	            	declared. This variable can be declared with a variable
        	            	"create_auto_group_ingress_https_from_public_internet_rules" {} block.

        	            	Error: Reference to undeclared input variable

        	            	  on ../../auto_group_rules.tf line 44, in resource "aws_security_group_rule" "auto_group_ingress_http_from_public_internet_rules":
        	            	  44:   for_each = var.create && var.create_auto_group_ingress_http_from_public_internet_rules ? { "ingress-http-80-tcp-from-public-internet" = null } : {}

        	            	An input variable with the name
        	            	"create_auto_group_ingress_http_from_public_internet_rules" has not been
        	            	declared. This variable can be declared with a variable
        	            	"create_auto_group_ingress_http_from_public_internet_rules" {} block.}
        	Test:       	TestTerraformCustomRulesExample
--- FAIL: TestTerraformCustomRulesExample (5.75s)
FAIL
FAIL	command-line-arguments	5.763s
FAIL
